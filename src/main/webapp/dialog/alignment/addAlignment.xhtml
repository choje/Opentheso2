<ui:fragment xmlns="http://www.w3.org/1999/xhtml"  
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:b="http://bootsfaces.net/ui"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
             xmlns:p="http://primefaces.org/ui"
             xmlns:f="http://xmlns.jcp.org/jsf/core">

    <p:dialog id="idAddAlignment" header="Alignement avec des thésaurus externes" widgetVar="addAlignment" 
              modal="true" resizable="true" position="top" width="1100" style="margin-top: 50px" >


        <h:form id="addAlignmentForm" rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isManagerOnThisTheso or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}">     

            <!-- Globale -->
            <b:row >

                <!-- bar de control -->
                <b:row>
                    <b:navBar fluid="true" style="background: #FAFAFA;" >
                        <b:column span="1" offset="8">
                            <b:navbarLinks pull="right" >
                                <b:dropMenu icon-awesome="filter" value="" style="font-size: 12px; color: #f47b2a;" contentStyle="font-size: 12px;">
                                    <b:selectBooleanCheckbox value="#{alignmentBean.withLang}" caption="Langues" tooltip="récupérer les traductions" tooltip-delay="1000"
                                                             style="margin-top: 2px;  font-size: 12px; " offset="1"/>
                                    <b:selectBooleanCheckbox value="#{alignmentBean.withNote}" caption="Notes" tooltip="récupérer les notes" tooltip-delay="1000"
                                                             style="margin-top: 2px;font-size: 12px;" offset="1"/>     
                                    <b:selectBooleanCheckbox value="#{alignmentBean.withImage}" caption="Images" tooltip="récupérer les images" tooltip-delay="1000"
                                                             style="margin-top: 2px;font-size: 12px;" offset="1"/>                                 
                                </b:dropMenu>

                            </b:navbarLinks>  
                        </b:column>                        

                        <b:column span="1">
                            <b:navbarLinks pull="right" >
                                <b:dropMenu rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}"
                                            icon-awesome="fas fa-cog" icon-size="s"  value="" iconAlign="right" tooltip="gérer les sources d'alignement" tooltip-delay-show="1000"
                                            style="color: #F7A269; background: none; border: none; box-shadow: none; font-size: 12px;">
                                    <b:navCommandLink value="Gérer les sources" 
                                                      action="#{setAlignmentSourceBean.init()}"
                                                      update="addAlignmentForm addAlignmentForm:columnRightPanel
                                                      addAlignmentForm:panelSetting"
                                                      style="font-size: 12px;"></b:navCommandLink>
                                    <b:navCommandLink value="Ajouter une source"
                                                      disabled="false"
                                                      tooltip="Ajouter une nouvelle source de type Opentheso"
                                                      action="#{setAlignmentSourceBean.initAddSource()}"
                                                      update="addAlignmentForm addAlignmentForm:columnRightPanel
                                                      addAlignmentForm:panelAddNewSource"
                                                      style="font-size: 12px;"></b:navCommandLink>                                                      
                                </b:dropMenu> 
                            </b:navbarLinks>
                        </b:column>                         

                        <b:column span="1">
                            <b:navbarLinks pull="right" >
                                <b:navLink ajax="true" update="idHelpAlignment" oncomplete="$('.helpAlignment').modal('show');" style="margin-right: -10px; margin-left: -5px;" >
                                    <b:iconAwesome value="fas fa-question" size="xl" style="color: #f47b2a;"/>
                                </b:navLink>
                            </b:navbarLinks>
                        </b:column>                            

                    </b:navBar>

                </b:row>

                <!-- panel gauche -->
                <b:column span="3" id="columnLeftPanel">
                    <b:panel style="height: 620px; margin-top: -20px;  ">

                        <!-- ligne navigation dans les concepts -->
                        <b:row>
                            <b:column span="4">
                                <b:navCommandLink value="set" id="reset" icon-awesome="fas fa-step-backward" style="color: #f47b2a"
                                                  action="#{alignmentBean.restart(conceptView.selectedLang,  selectedTheso.currentIdTheso)}"
                                                  styleClass="styleButton_db"
                                                  update="addAlignmentForm:columnLeftPanel"/>
                            </b:column>
                            <b:column span="4">                
                                <b:navCommandLink value="pre" id="previous" icon-awesome="fas fa-arrow-circle-left" style="color: #43B572"
                                                  action="#{alignmentBean.previousTen(conceptView.selectedLang,  selectedTheso.currentIdTheso)}" 
                                                  styleClass="styleButton_db"
                                                  update="addAlignmentForm:columnLeftPanel"/>
                            </b:column>
                            <b:column span="4">
                                <b:navCommandLink value="next" id="next" icon-awesome="fas fa-arrow-circle-right" style="color: #43B572"
                                                  action="#{alignmentBean.nextTen(conceptView.selectedLang,  selectedTheso.currentIdTheso)}"
                                                  styleClass="styleButton_db"
                                                  update="addAlignmentForm:columnLeftPanel"/>
                            </b:column>
                        </b:row>

                        <!-- ligne liste des concepts -->
                        <b:row>
                            <b:column span="12">
                                <b:panel style="margin-top: 10px; margin-left: -10px; margin-right: -10px; height: 570px; overflow-y:scroll">
                                    <b:listLinks style="margin-left: -20px">
                                        <ui:repeat var="conceptList" value="#{alignmentBean.idsAndValues}">
                                            <b:row>
                                                <b:column span="11" offset="1">
                                                    <b:navCommandLink value="#{conceptList.value}"
                                                                      actionListener="#{alignmentBean.selectConceptForAlignment(conceptList.id)}"
                                                                      update="formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel 
                                                                      formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel:columnRightPanelLocal"/>
                                                </b:column>
                                            </b:row>
                                        </ui:repeat>
                                    </b:listLinks>
                                </b:panel>
                            </b:column>
                        </b:row>
                    </b:panel>
                </b:column>



                <!-- panel droit -->
                <b:column span="9" id="columnRightPanel" rendered="#{!alignmentBean.viewSetting and !alignmentBean.viewAddNewSource}">
                    <b:row>
                        <!-- thesaurus distant -->
                        <b:column span="6" id="columnRightPanelSource">
                            <b:panel style="height: 620px; margin-top: -20px; margin-left: -20px">
                                <b:row  rendered="#{!alignmentBean.isViewSelection}">    

                                    <b:column span="5" rendered="#{!alignmentBean.isNameAlignment}" style="font-size: 12px; margin-top: -5px">
                                        <b:inputText value="#{alignmentBean.conceptValueForAlignment}" 
                                                     tooltip="concept à aligner" tooltip-delay-show="1000"
                                                     style="height: 25px; border-color: #43B572" />
                                    </b:column>

                                    <!-- nom et prénom pour IdRef -->
                                    <b:column span="3" rendered="#{alignmentBean.isNameAlignment}" style="font-size: 12px; margin-top: -5px" >
                                        <b:inputText tooltip="Nom" placeholder="Nom" tooltip-delay-show="1000"
                                                     value="#{alignmentBean.nom}" 
                                                     style="height: 25px; border-color: #43B572"/>
                                    </b:column>
                                    <b:column span="3" rendered="#{alignmentBean.isNameAlignment}"  style="font-size: 12px; margin-top: -5px">
                                        <b:inputText tooltip="Prenom" placeholder="Prenom" tooltip-delay-show="1000"
                                                     value="#{alignmentBean.prenom}" 
                                                     style="height: 25px; border-color: #43B572"/>
                                    </b:column>

                                    <b:column span="4" style="font-size: 12px; margin-top: -5px; ">
                                        <p:selectOneMenu id="console" value="#{alignmentBean.selectedAlignement}"
                                                         style="font-size: 12px; width: 100%; background: white; border-color: #43B572"
                                                         
                                                         panelStyle="font-size: 12px; background: red; border: none; box-shadow: none;">
                                            <f:selectItems  value="#{alignmentBean.alignementSources}" var="alig" itemLabel="#{alig.source}" itemValue="#{alig.source}"/>                                
                                            <p:ajax event="change" listener="#{alignmentBean.actionChoix()}"  update="formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel"/>
                                        </p:selectOneMenu>                                
                                    </b:column>

                                    <b:column span="1" style="font-size: 12px;">
                                        <b:navCommandLink id="cbAjAlignAuto" tooltip="Chercher les alignements" tooltip-delay-show="1000"
                                                          iconAwesome="search" style="color: #f47b2a; "
                                                          action="#{alignmentBean.searchAlignments(
                                                                    selectedTheso.selectedIdTheso, 
                                                                    alignmentBean.idConceptSelectedForAlignment,
                                                                    alignmentBean.conceptValueForAlignment,
                                                                    conceptView.selectedLang)}"
                                                          update="formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel"
                                                          styleClass="styleButton_db" />
                                    </b:column> 
                                    <b:column span="1" offset="1">
                                        <b:iconAwesome value="fas fa-exchange-alt" style="font-size: 14px; color: #f47b2a"
                                                       tooltip="Aligner avec ->" tooltip-delay-show="1000"/>
                                    </b:column>
                                </b:row>


                                <!-- panel de résultat -->
                                <b:row id="columnRightPanelResult">
                                    <b:column span="12" rendered="#{alignmentBean.isViewResult}">
                                        <b:panel style="margin-top: -10px; margin-left: -10px; margin-right: -10px; height: 570px; overflow: scroll">
                                            <b:row rendered="#{(alignmentBean.listAlignValues.size() == 0)}">
                                                <b:column span="12">
                                                    <b:alert severity="warning" style="font-size: 12px"> <strong> Pas de résultat!</strong> aucun résultat trouvé pour ce label.
                                                        <br/>
                                                        Vous pouvez ajouter l'alignement manuellement ci-dessous :
                                                    </b:alert>
                                                </b:column>
                                            </b:row>

                                            <!-- Ajout d'alignement manuel -->
                                            <b:row rendered="#{(alignmentBean.listAlignValues.size() == 0)}">
                                                <b:column span="12">
                                                    <b:row >
                                                        <b:column span="12" style="background: #FAFAFA">
                                                            <b:inputText value="#{conceptView.nodeConcept.term.lexical_value}"
                                                                         label="concept local"
                                                                         disabled="true"
                                                                         style="color: #43B572; font-size: 12px;"/>                    
                                                        </b:column>
                                                    </b:row>
                                                    <b:row >
                                                        <b:column span="12" style="background: #FAFAFA">
                                                            <b:selectOneMenu id="relationType"  value="#{alignmentManualBean.manualAlignmentType}"  label="type d'équivalence"
                                                                             style="font-size: 12px; background: white; border-color: #43B572">
                                                                <f:selectItems value="#{alignmentManualBean.nodeAlignmentTypes}" var="types"
                                                                               itemLabel="#{types.label} (#{types.labelSkos})" itemValue="#{types.id}"/>
                                                            </b:selectOneMenu>  
                                                        </b:column>
                                                    </b:row>
                                                    <b:row >
                                                        <b:column span="12" style="background: #FAFAFA">
                                                            <b:inputText value="#{alignmentManualBean.manualAlignmentUri}"
                                                                         label="Uri distante" 
                                                                         style="color: #43B572; font-size: 12px;"/>                    
                                                        </b:column>
                                                    </b:row>
                                                    <b:row >            
                                                        <b:column span="12" style="background: #FAFAFA">
                                                            <b:inputText value="#{alignmentManualBean.manualAlignmentSource}"
                                                                         label="Nome de la source" 
                                                                         disabled="true"
                                                                         style="color: #43B572; font-size: 12px;"/>                    
                                                        </b:column>
                                                    </b:row>     


                                                    <b:row style="margin-bottom: 10px;">
                                                        <b:column span="4" >
                                                            <b:commandButton id="buttonCancelManual" value="Cancel" 
                                                                             style="width:100%; font-size: 13px; 
                                                                             font-weight: normal;
                                                                             color: white; background: #8C8C8C; border: none; box-shadow: none;"
                                                                             class="btn btn-primary"
                                                                             action="#{alignmentBean.cancelManualAlignment()}"
                                                                             update="formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel"/>
                                                        </b:column>                                                              
                                                        <b:column span="4" offset="4" >
                                                            <b:commandButton id="buttonSubmitManual" value="Valider" 
                                                                             style="width:100%; font-size: 13px; 
                                                                             font-weight: normal;
                                                                             color: white; background: #F7A269; border: none; box-shadow: none;"
                                                                             class="btn btn-primary"
                                                                             update="formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel"
                                                                             actionListener="#{alignmentManualBean.addManualAlignement()}"
                                                                             action="#{alignmentBean.validManualAlignment()}" />
                                                        </b:column>                    
                                                        <p:spacer height="20" />
                                                    </b:row>

                                                    <b:row>
                                                        <b:column span="12">
                                                            <b:messages autoUpdate="true"/>
                                                        </b:column>
                                                    </b:row> 
                                                </b:column>                                                
                                            </b:row>
                                            <!-- Fin Ajout d'alignement manuel -->











                                            <b:row id="alignementChoiceConfStep" rendered="#{alignmentBean.alignementSources == null || alignmentBean.alignementSources.size() == 0}">
                                                <b:column span="12">
                                                    <b:alert severity="danger" style="font-size: 12px" value="#{langueBean.getMsg('alig.NeedToParameter')}"/>
                                                </b:column>
                                            </b:row>
                                            <ui:repeat rendered="#{alignmentBean.listAlignValues != null}" value="#{alignmentBean.listAlignValues}" var='nodeAlign'>
                                                <b:row>
                                                    <b:column span="10">
                                                        <b:row>
                                                            <b:column span="12">
                                                                <h:outputText value="#{nodeAlign.concept_target}: " style="font-weight: bold; font-size: 12px"/> 
                                                            </b:column>
                                                        </b:row>
                                                        <b:row rendered="#{nodeAlign.concept_target_alt.trim() != null and nodeAlign.concept_target_alt.trim() != ''}">
                                                            <b:column span="12" >
                                                                <h:outputText rendered="#{nodeAlign.concept_target_alt.trim() != null and nodeAlign.concept_target_alt.trim() != ''}" 
                                                                              value="altLable : #{nodeAlign.concept_target_alt}&lt;br/&gt;" escape="false" /> 
                                                            </b:column>
                                                        </b:row>
                                                        <b:row rendered="#{nodeAlign.def_target.trim() != null and nodeAlign.def_target.trim() != ''}">
                                                            <b:column span="12">
                                                                <h:outputText rendered="#{nodeAlign.def_target.trim() != null and nodeAlign.def_target.trim() != ''}" value="#{nodeAlign.def_target}&lt;br/&gt;" escape="false" />
                                                            </b:column>
                                                        </b:row>                                        
                                                        <b:row>
                                                            <b:column span="12">
                                                                <h:outputLink value="#{nodeAlign.uri_target}" target="_blank" ><h:outputText value="#{nodeAlign.uri_target}" /></h:outputLink><br/>
                                                            </b:column>
                                                        </b:row>                                          
                                                    </b:column>

                                                    <b:column span="1">
                                                        <b:navCommandLink iconAwesome="fas fa-file-import" style="font-size: 14px; color: #f47b2a;"
                                                                          tooltip="selectionner cet alignement" tooltip-delay-show="1000"
                                                                          action="#{alignmentBean.getUriAndOptions(
                                                                                    nodeAlign,
                                                                                    selectedTheso.selectedIdTheso,
                                                                                    conceptView.nodeConcept.concept.idConcept)}"
                                                                          update="formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel">
                                                        </b:navCommandLink>
                                                    </b:column>                                            

                                                </b:row> 
                                                <p:separator styleClass="separator" style="margin-top: 2px"/>
                                            </ui:repeat>
                                        </b:panel>
                                    </b:column>


                                    <!-- panel de validation d'un alignement avec les options-->
                                    <b:column span="12" rendered="#{alignmentBean.isViewSelection}">
                                        <b:panel style="margin-top: -15px; margin-left: -10px; margin-right: -10px; height: 610px; overflow: scroll; font-size: 12px;">

                                            <b:row>
                                                <b:column span="3">
                                                    <h:outputText value="#{alignmentBean.conceptValueForAlignment}"  style="font-size: 12px; color: #43B572"/>
                                                </b:column>
                                                <b:column span="4">
                                                    <p:selectOneMenu id="alignmentType" value="#{alignmentBean.selectedAlignementType}"
                                                                     title="Type d'alignement"
                                                                     style="font-size: 12px; width: 100%; background: white; border-color: #43B572"
                                                                     panelStyle="font-size: 12px; background: none; border: none; box-shadow: none;">
                                                        <f:selectItems value="#{alignmentBean.alignmentTypes}" var="type" itemLabel="#{type.value}" itemValue="#{type.key}" />
                                                    </p:selectOneMenu>
                                                </b:column>
                                                <b:column span="3">
                                                    <h:outputText value=" #{alignmentBean.selectedNodeAlignment.concept_target} (#{alignmentBean.selectedAlignement})"
                                                                  title="#{alignmentBean.selectedNodeAlignment.uri_target}" style="font-size: 12px; color: #43B572"/>
                                                </b:column>

                                                <b:column span="1">
                                                    <b:navCommandLink id="align" iconAwesome="fas fa-check-circle fas 2x" style="color: #f47b2a"
                                                                      tooltip="Valider l'alignement" tooltip-delay-show="1000"
                                                                      actionListener="#{alignmentBean.addAlignment(
                                                                                        selectedTheso.selectedIdTheso, 
                                                                                        alignmentBean.idConceptSelectedForAlignment,
                                                                                        currentUser.nodeUser.idUser)}"
                                                                      update="formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel
                                                                      formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel:columnRightPanelLocal" >
                                                    </b:navCommandLink>
                                                </b:column>
                                                <b:column span="1">
                                                    <b:navCommandLink id="cancel" iconAwesome="fas fa-undo" style="color: #f47b2a"
                                                                      tooltip="Retour sans aligner"  tooltip-delay-show="1000"
                                                                      action="#{alignmentBean.cancelAlignment()}"
                                                                      update="formRightTab:viewTabConcept:addAlignmentForm:columnRightPanel">
                                                    </b:navCommandLink>  
                                                </b:column>                                            
                                            </b:row>
                                            <p:separator styleClass="separator" style="margin-top: 2px"/>

                                            <h:panelGroup id="listOptions" style="font-size: 12px;"> 

                                                <!-- langues externes -->
                                                <b:row rendered="#{(alignmentBean.traductionsOfAlignment != null) and (alignmentBean.traductionsOfAlignment.size() != 0)}">
                                                    <b:column span="12">
                                                        <h:outputText value="traductions de #{alignmentBean.selectedAlignement}" />
                                                    </b:column>
                                                </b:row>

                                                <ui:repeat rendered="#{(alignmentBean.traductionsOfAlignment != null) and (alignmentBean.traductionsOfAlignment.size() != 0)}"
                                                           value="#{alignmentBean.traductionsOfAlignment}" var='externalTraductions'>
                                                    <b:row>
                                                        <b:column span="3">
                                                            <b:inputText value="#{externalTraductions.idLang}" disabled="true" style="height: 25px;"/>
                                                        </b:column>
                                                        <b:column span="4">
                                                            <b:inputText value="#{externalTraductions.localValue}" disabled="true"
                                                                         tooltip="valeur locale" tooltip-delay-show="1000"
                                                                         style="height: 25px;"/>
                                                        </b:column>
                                                        <b:column span="4">
                                                            <b:inputText value="#{externalTraductions.gettedValue}" style="height: 25px;"/>
                                                        </b:column>                                                            
                                                        <b:column span="1" >
                                                            <b:selectBooleanCheckbox value="#{externalTraductions.selected}" />
                                                        </b:column>                                                                 
                                                    </b:row>
                                                </ui:repeat>



                                                <!-- Notes externes -->
                                                <b:row rendered="#{(alignmentBean.descriptionsOfAlignment != null) and (alignmentBean.descriptionsOfAlignment.size() != 0)}">
                                                    <b:column span="12">
                                                        <h:outputText value="Définition de #{alignmentBean.selectedAlignement}" />
                                                    </b:column>
                                                </b:row>

                                                <ui:repeat rendered="#{(alignmentBean.descriptionsOfAlignment != null) and (alignmentBean.descriptionsOfAlignment.size() != 0)}"
                                                           value="#{alignmentBean.descriptionsOfAlignment}" var='notes'>
                                                    <b:row>
                                                        <b:column span="3">
                                                            <b:inputText value="#{notes.idLang}" disabled="true" style="height: 25px;"/>
                                                        </b:column>
                                                        <b:column span="8">
                                                            <b:inputTextarea value="#{notes.gettedValue}" style="height: 50px;"/>
                                                        </b:column>                                                            
                                                        <b:column span="1" >
                                                            <b:selectBooleanCheckbox value="#{notes.selected}" />
                                                        </b:column>                                                                 
                                                    </b:row>
                                                </ui:repeat> 


                                                <!-- images externes -->
                                                <b:row rendered="#{(alignmentBean.imagesOfAlignment != null) and (alignmentBean.imagesOfAlignment.size() != 0)}">
                                                    <b:column span="12">
                                                        <h:outputText value="Images de #{alignmentBean.selectedAlignement}"  />
                                                    </b:column>
                                                </b:row>

                                                <ui:repeat rendered="#{(alignmentBean.imagesOfAlignment != null) and (alignmentBean.imagesOfAlignment.size() != 0)}"
                                                           value="#{alignmentBean.imagesOfAlignment}" var='images'>
                                                    <b:row>
                                                        <b:column span="6">
                                                            <b:inputText value="#{images.gettedValue}"  style="height: 25px;"/>
                                                        </b:column>
                                                        <b:column span="5">
                                                            <p:graphicImage value="#{images.gettedValue}" style="height: 50px;"/>
                                                        </b:column>                                                            
                                                        <b:column span="1" >
                                                            <b:selectBooleanCheckbox value="#{images.selected}" />
                                                        </b:column>                                                                 
                                                    </b:row>
                                                </ui:repeat>                                                     

                                            </h:panelGroup> 

                                        </b:panel>
                                    </b:column>

                                </b:row>                                




                            </b:panel>
                        </b:column>
                        <!-- fin pour thésaurus distant -->




                        <!-- thesaurus local -->
                        <b:column span="6" id="columnRightPanelLocal"> 
                            <b:panel style="height: 620px; margin-top: -20px; margin-left: -20px">
                                <b:row>
                                    <b:column span="12">
                                        <h:outputText value="#{selectedTheso.thesoName} (#{selectedTheso.currentIdTheso})"/>
                                    </b:column>
                                </b:row>
                                <b:row>
                                    <b:column span="12">                            
                                        <b:panel style="margin-top: 10px; margin-left: -10px; margin-right: -10px; height: 570px; overflow-y:scroll">

                                            <!-- alignements existants -->
                                            <b:row>
                                                <b:column span="12" rendered="#{alignmentBean.existingAlignments.size() != 0}">
                                                    <ui:repeat var="align" value="#{alignmentBean.existingAlignments}" >
                                                        <b:row>
                                                            <b:column >
                                                                <b:link href="#{align.uri_target}"
                                                                        value="#{align.uri_target}"
                                                                        tooltip="#{align.thesaurus_target}" tooltip-delay-show="1000"
                                                                        target="_blank"
                                                                        icon="link" icon-size="sm" style="font-size: 12px; color: #43B572;"></b:link>                            
                                                            </b:column> 
                                                        </b:row> 
                                                    </ui:repeat>
                                                    <p:separator styleClass="separator" style="margin-top: 2px"/>                
                                                </b:column>
                                            </b:row> 


                                            <!-- ligne infos -->
                                            <b:row>  
                                                <b:column span="12">
                                                    <b:messages autoUpdate="true"/>
                                                </b:column>
                                            </b:row>

                                        </b:panel>
                                    </b:column>
                                </b:row>
                            </b:panel>
                        </b:column>

                        <!-- fin de panel thésaurus local -->



                    </b:row>
                </b:column>
                <!-- fin de panel droit -->




                <!-- Pour paramétrer les sources -->

                <b:row id="panelSetting" rendered="#{alignmentBean.viewSetting}" >
                    <b:column span="6" >
                        <b:panel style="height: 620px; margin-top: -20px; margin-left: -20px">

                            <b:row >
                                <b:column span="11" offset="1" >
                                    <h:outputText id="currentPrefLabel" value="#{selectedTheso.thesoName} (#{selectedTheso.currentIdTheso})"
                                                  style="font-size: 13px; color: black;">
                                    </h:outputText >
                                    <p:spacer height="30"/>
                                </b:column>
                            </b:row>      

                            <b:panel style="height: 400px; margin-top: -20px; overflow-y:scroll">
                                <ui:repeat var="alignmentSource" value="#{setAlignmentSourceBean.nodeSelectedAlignmentsAll}" >
                                    <b:row >
                                        <b:column span="5">
                                            <b:selectBooleanCheckbox value="#{alignmentSource.isSelected}" caption="#{alignmentSource.sourceLabel}"
                                                                     tooltip="#{alignmentSource.sourceDescription}" tooltip-delay="1000"
                                                                     style=" font-size: 12px; " offset="1"/>
                                        </b:column>
                                        <b:column span="7" >
                                            <b:inputText disabled="true" 
                                                         value="#{alignmentSource.sourceLabel}"
                                                         tooltip="#{alignmentSource.sourceDescription}" tooltip-delay-show="1000"
                                                         style="color: #43B572; font-size: 12px;"/>                    
                                        </b:column>
                                    </b:row>
                                </ui:repeat>
                            </b:panel>  
                            <b:row style="margin-bottom: 10px;">
                                <b:column span="4" offset="3" >
                                    <b:commandButton id="buttonCancel" value="cancel"
                                                     update="addAlignmentForm addAlignmentForm:columnRightPanel
                                                     addAlignmentForm:panelSetting"
                                                     style="width:100%; font-size: 13px; 
                                                     font-weight: normal;
                                                     color: white; background: #8C8C8C; border: none; box-shadow: none;"
                                                     class="btn btn-primary"
                                                     action="#{setAlignmentSourceBean.cancel()}"/>
                                </b:column>                                    
                                <b:column span="4" offset="1" >
                                    <b:commandButton id="buttonSubmit" value="Valider"
                                                     update="addAlignmentForm addAlignmentForm:columnRightPanel
                                                     addAlignmentForm:panelSetting"
                                                     style="width:100%; font-size: 13px; 
                                                     font-weight: normal;
                                                     color: white; background: #F7A269; border: none; box-shadow: none;"
                                                     class="btn btn-primary"
                                                     action="#{setAlignmentSourceBean.updateSelectedAlignment()}"/>
                                </b:column>
                            </b:row>                                

                        </b:panel>
                    </b:column>
                </b:row>   


                <!-- Pour ajouter une nouvelle source de type Opentheso -->
                <b:row id="panelAddNewSource" rendered="#{alignmentBean.viewAddNewSource}" >
                    <b:column span="6" >
                        <b:panel style="height: 620px; margin-top: -20px; margin-left: -20px">

                            <b:row style="margin-top: 10px;">
                                <b:column span="2" offset="1">
                                    <h:outputText value="Nom" style="font-size: 12px;"/>
                                </b:column>
                                <b:column span="7">
                                    <b:inputText placeholder="Nom de la source" value="#{setAlignmentSourceBean.sourceName}" 
                                                 style="font-size: 12px; height: 25px; "/>
                                </b:column>                                  
                            </b:row>
                            
                            <b:row>
                                <b:column span="2" offset="1">
                                    <h:outputText value="Uri" style="font-size: 12px;"/>
                                </b:column>
                                <b:column span="7">
                                    <b:inputText placeholder="Uri du serveur" value="#{setAlignmentSourceBean.sourceUri}"
                                                 style="font-size: 12px; height: 25px;"
                                                 tooltip="Indiquer l'URL du serveur exemple (https://monserveur.fr/opentheso)" tooltip-delay-show="500"/>
                                </b:column>                                  
                            </b:row>    
                            
                            <b:row>
                                <b:column span="2" offset="1">
                                    <h:outputText value="Id. du thésaurus" style="font-size: 12px;"/>
                                </b:column>
                                <b:column span="7">
                                    <b:inputText placeholder="Identifiant du thésaurus" value="#{setAlignmentSourceBean.sourceIdTheso}"
                                                 style="font-size: 12px; height: 25px;"
                                                 tooltip="Indiquer l'identifiant du thésaurus exemple (th1)" tooltip-delay-show="500"/>
                                </b:column>                                  
                            </b:row>        
                            
                            <b:row>
                                <b:column span="2" offset="1">
                                    <h:outputText value="Description" style="font-size: 12px;"/>
                                </b:column>
                                <b:column span="7">
                                    <b:inputText placeholder="note" value="#{setAlignmentSourceBean.description}"
                                                 style="font-size: 12px; height: 25px;"
                                                 tooltip="Description de cette source" tooltip-delay-show="500"/>
                                </b:column>                                  
                            </b:row>                            
                            <p:spacer/>
                            <b:row style="margin-bottom: 10px;">
                                <b:column span="4" offset="1" >
                                    <b:commandButton id="buttonCancel2" value="cancel"
                                                     update="addAlignmentForm addAlignmentForm:columnRightPanel
                                                     addAlignmentForm:panelAddNewSource"
                                                     style="width:100%; font-size: 13px; 
                                                     font-weight: normal;
                                                     color: white; background: #8C8C8C; border: none; box-shadow: none;"
                                                     class="btn btn-primary"
                                                     action="#{setAlignmentSourceBean.cancel()}"/>
                                </b:column>                                    
                                <b:column span="4" offset="1" >
                                    <b:commandButton id="buttonSubmit2" value="Ajouter"
                                                     update="addAlignmentForm addAlignmentForm:columnRightPanel
                                                     addAlignmentForm:panelAddNewSource"
                                                     style="width:100%; font-size: 13px; 
                                                     font-weight: normal;
                                                     color: white; background: #F7A269; border: none; box-shadow: none;"
                                                     class="btn btn-primary"
                                                     action="#{setAlignmentSourceBean.addAlignmentSource(currentUser.nodeUser.idUser)}"/>
                                </b:column>
                            </b:row>  
                        </b:panel>
                    </b:column>
                </b:row>                  


            </b:row>
        </h:form>

    </p:dialog>   

</ui:fragment>